<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chương 5 Tính toán trên các phần tử trong Pandas | Kungfu Pandas</title>
  <meta name="description" content="Kungfu Panda" />
  <meta name="generator" content="bookdown 0.25 and GitBook 2.6.7" />

  <meta property="og:title" content="Chương 5 Tính toán trên các phần tử trong Pandas | Kungfu Pandas" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Kungfu Panda" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chương 5 Tính toán trên các phần tử trong Pandas | Kungfu Pandas" />
  
  <meta name="twitter:description" content="Kungfu Panda" />
  

<meta name="author" content="Lê Huỳnh Đức" />


<meta name="date" content="2022-04-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="selecting-và-filtering.html"/>
<link rel="next" href="các-cách-phối-hợp-nhiều-bảng-với-nhau.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="css/style.css" type="text/css" />
<link rel="stylesheet" href="css/toc.css" type="text/css" />
<link rel="stylesheet" href="css/highlight.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Kungfu Pandas</a></li>

<li class="divider"></li>
<li><a href="index.html#lời-nói-đầu" id="toc-lời-nói-đầu">Lời nói đầu<span></span></a>
<ul>
<li><a href="index.html#giới-thiệu-cuốn-sách" id="toc-giới-thiệu-cuốn-sách">Giới thiệu cuốn sách<span></span></a></li>
<li><a href="index.html#giới-thiệu-tác-giả" id="toc-giới-thiệu-tác-giả">Giới thiệu tác giả<span></span></a></li>
</ul></li>
<li><a href="cấu-trúc-và-kiểu-dữ-liệu.html#cấu-trúc-và-kiểu-dữ-liệu" id="toc-cấu-trúc-và-kiểu-dữ-liệu"><span class="toc-section-number">1</span> Cấu trúc và kiểu dữ liệu<span></span></a>
<ul>
<li><a href="cấu-trúc-và-kiểu-dữ-liệu.html#series" id="toc-series"><span class="toc-section-number">1.1</span> Series<span></span></a>
<ul>
<li><a href="cấu-trúc-và-kiểu-dữ-liệu.html#các-cách-khởi-tạo" id="toc-các-cách-khởi-tạo"><span class="toc-section-number">1.1.1</span> Các cách khởi tạo<span></span></a></li>
<li><a href="cấu-trúc-và-kiểu-dữ-liệu.html#một-số-thao-tác-cơ-bản" id="toc-một-số-thao-tác-cơ-bản"><span class="toc-section-number">1.1.2</span> Một số thao tác cơ bản<span></span></a></li>
</ul></li>
<li><a href="cấu-trúc-và-kiểu-dữ-liệu.html#cach-khoi-tao-data-frame" id="toc-cach-khoi-tao-data-frame"><span class="toc-section-number">1.2</span> DataFrame<span></span></a>
<ul>
<li><a href="cấu-trúc-và-kiểu-dữ-liệu.html#các-cách-khởi-tạo-1" id="toc-các-cách-khởi-tạo-1"><span class="toc-section-number">1.2.1</span> Các cách khởi tạo<span></span></a></li>
<li><a href="cấu-trúc-và-kiểu-dữ-liệu.html#các-hàm-khởi-tạo-thay-thế" id="toc-các-hàm-khởi-tạo-thay-thế"><span class="toc-section-number">1.2.2</span> Các hàm khởi tạo thay thế<span></span></a></li>
</ul></li>
<li><a href="cấu-trúc-và-kiểu-dữ-liệu.html#data-type-trong-pandas" id="toc-data-type-trong-pandas"><span class="toc-section-number">1.3</span> Data type trong pandas<span></span></a></li>
</ul></li>
<li><a href="nhập-xuất-trong-pandas.html#nhập-xuất-trong-pandas" id="toc-nhập-xuất-trong-pandas"><span class="toc-section-number">2</span> Nhập xuất trong pandas<span></span></a>
<ul>
<li><a href="nhập-xuất-trong-pandas.html#đọc-và-lưu-file" id="toc-đọc-và-lưu-file"><span class="toc-section-number">2.1</span> Đọc và lưu file<span></span></a>
<ul>
<li><a href="nhập-xuất-trong-pandas.html#csv-tsv" id="toc-csv-tsv"><span class="toc-section-number">2.1.1</span> csv, tsv<span></span></a></li>
<li><a href="nhập-xuất-trong-pandas.html#excel" id="toc-excel"><span class="toc-section-number">2.1.2</span> Excel<span></span></a></li>
<li><a href="nhập-xuất-trong-pandas.html#json" id="toc-json"><span class="toc-section-number">2.1.3</span> JSON<span></span></a></li>
<li><a href="nhập-xuất-trong-pandas.html#pickle" id="toc-pickle"><span class="toc-section-number">2.1.4</span> Pickle<span></span></a></li>
</ul></li>
<li><a href="nhập-xuất-trong-pandas.html#cấu-hình-pandas" id="toc-cấu-hình-pandas"><span class="toc-section-number">2.2</span> Cấu hình pandas<span></span></a></li>
</ul></li>
<li><a href="Chuong-3.html#Chuong-3" id="toc-Chuong-3"><span class="toc-section-number">3</span> Một số hàm cơ bản<span></span></a>
<ul>
<li><a href="Chuong-3.html#head-và-.tail" id="toc-head-và-.tail"><span class="toc-section-number">3.1</span> <code>.head()</code> và <code>.tail()</code><span></span></a></li>
<li><a href="Chuong-3.html#shape-và-.size" id="toc-shape-và-.size"><span class="toc-section-number">3.2</span> <code>.shape</code> và <code>.size</code><span></span></a></li>
<li><a href="Chuong-3.html#info" id="toc-info"><span class="toc-section-number">3.3</span> <code>.info()</code><span></span></a></li>
<li><a href="Chuong-3.html#describe" id="toc-describe"><span class="toc-section-number">3.4</span> <code>.describe()</code><span></span></a></li>
<li><a href="Chuong-3.html#index" id="toc-index"><span class="toc-section-number">3.5</span> <code>.index</code><span></span></a></li>
<li><a href="Chuong-3.html#memory_usage" id="toc-memory_usage"><span class="toc-section-number">3.6</span> <code>.memory_usage()</code><span></span></a></li>
<li><a href="Chuong-3.html#lấy-series-trong-pandas" id="toc-lấy-series-trong-pandas"><span class="toc-section-number">3.7</span> Lấy Series trong pandas<span></span></a></li>
<li><a href="Chuong-3.html#astype" id="toc-astype"><span class="toc-section-number">3.8</span> <code>.astype()</code><span></span></a></li>
<li><a href="Chuong-3.html#drop_duplicates" id="toc-drop_duplicates"><span class="toc-section-number">3.9</span> <code>.drop_duplicates()</code><span></span></a></li>
<li><a href="Chuong-3.html#value_counts" id="toc-value_counts"><span class="toc-section-number">3.10</span> <code>.value_counts()</code><span></span></a></li>
<li><a href="Chuong-3.html#unique-và-.nunique" id="toc-unique-và-.nunique"><span class="toc-section-number">3.11</span> <code>.unique()</code> và <code>.nunique()</code><span></span></a></li>
<li><a href="Chuong-3.html#drop" id="toc-drop"><span class="toc-section-number">3.12</span> <code>.drop()</code><span></span></a></li>
<li><a href="Chuong-3.html#rename" id="toc-rename"><span class="toc-section-number">3.13</span> <code>.rename()</code><span></span></a></li>
<li><a href="Chuong-3.html#set_index" id="toc-set_index"><span class="toc-section-number">3.14</span> <code>.set_index()</code><span></span></a></li>
<li><a href="Chuong-3.html#sort_index" id="toc-sort_index"><span class="toc-section-number">3.15</span> <code>.sort_index</code><span></span></a></li>
<li><a href="Chuong-3.html#sort_values" id="toc-sort_values"><span class="toc-section-number">3.16</span> <code>.sort_values</code><span></span></a></li>
</ul></li>
<li><a href="selecting-và-filtering.html#selecting-và-filtering" id="toc-selecting-và-filtering"><span class="toc-section-number">4</span> Selecting và Filtering<span></span></a>
<ul>
<li><a href="selecting-và-filtering.html#sử-dụng" id="toc-sử-dụng"><span class="toc-section-number">4.1</span> Sử dụng <code>[]</code><span></span></a></li>
<li><a href="selecting-và-filtering.html#loc-và-.iloc" id="toc-loc-và-.iloc"><span class="toc-section-number">4.2</span> .loc và .iloc<span></span></a>
<ul>
<li><a href="selecting-và-filtering.html#loc" id="toc-loc"><span class="toc-section-number">4.2.1</span> .loc<span></span></a></li>
<li><a href="selecting-và-filtering.html#iloc" id="toc-iloc"><span class="toc-section-number">4.2.2</span> <code>.iloc</code><span></span></a></li>
</ul></li>
<li><a href="selecting-và-filtering.html#lọc-theo-điều-kiện" id="toc-lọc-theo-điều-kiện"><span class="toc-section-number">4.3</span> Lọc theo điều kiện<span></span></a>
<ul>
<li><a href="selecting-và-filtering.html#toán-tử-điều-kiện" id="toc-toán-tử-điều-kiện"><span class="toc-section-number">4.3.1</span> Toán tử điều kiện<span></span></a></li>
<li><a href="selecting-và-filtering.html#isin" id="toc-isin"><span class="toc-section-number">4.3.2</span> <code>.isin()</code><span></span></a></li>
<li><a href="selecting-và-filtering.html#lọc-missing-value-với-.dropna" id="toc-lọc-missing-value-với-.dropna"><span class="toc-section-number">4.3.3</span> Lọc missing value với <code>.dropna()</code><span></span></a></li>
</ul></li>
</ul></li>
<li><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#tính-toán-trên-các-phần-tử-trong-pandas" id="toc-tính-toán-trên-các-phần-tử-trong-pandas"><span class="toc-section-number">5</span> Tính toán trên các phần tử trong Pandas<span></span></a>
<ul>
<li><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#sử-dụng-vectorization" id="toc-sử-dụng-vectorization"><span class="toc-section-number">5.1</span> Sử dụng Vectorization<span></span></a></li>
<li><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#sử-dụng-apply" id="toc-sử-dụng-apply"><span class="toc-section-number">5.2</span> Sử dụng apply<span></span></a></li>
<li><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#sử-dụng-iterator" id="toc-sử-dụng-iterator"><span class="toc-section-number">5.3</span> Sử dụng iterator<span></span></a></li>
<li><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#xử-lý-song-song-trong-pandas" id="toc-xử-lý-song-song-trong-pandas"><span class="toc-section-number">5.4</span> Xử lý song song trong pandas<span></span></a></li>
</ul></li>
<li><a href="các-cách-phối-hợp-nhiều-bảng-với-nhau.html#các-cách-phối-hợp-nhiều-bảng-với-nhau" id="toc-các-cách-phối-hợp-nhiều-bảng-với-nhau"><span class="toc-section-number">6</span> Các cách phối hợp nhiều bảng với nhau<span></span></a>
<ul>
<li><a href="các-cách-phối-hợp-nhiều-bảng-với-nhau.html#join" id="toc-join"><span class="toc-section-number">6.1</span> Join<span></span></a></li>
<li><a href="các-cách-phối-hợp-nhiều-bảng-với-nhau.html#merge" id="toc-merge"><span class="toc-section-number">6.2</span> Merge<span></span></a></li>
<li><a href="các-cách-phối-hợp-nhiều-bảng-với-nhau.html#concat" id="toc-concat"><span class="toc-section-number">6.3</span> Concat<span></span></a></li>
</ul></li>
<li><a href="groupby.html#groupby" id="toc-groupby"><span class="toc-section-number">7</span> Groupby<span></span></a>
<ul>
<li><a href="groupby.html#groupby-1" id="toc-groupby-1"><span class="toc-section-number">7.1</span> Groupby<span></span></a></li>
<li><a href="groupby.html#các-hàm-filtering-trong-groupby" id="toc-các-hàm-filtering-trong-groupby"><span class="toc-section-number">7.2</span> Các hàm Filtering trong Groupby<span></span></a></li>
<li><a href="groupby.html#aggregate-trong-groupby" id="toc-aggregate-trong-groupby"><span class="toc-section-number">7.3</span> Aggregate trong Groupby<span></span></a></li>
</ul></li>
<li><a href="làm-việc-với-1-số-kiểu-dữ-liệu.html#làm-việc-với-1-số-kiểu-dữ-liệu" id="toc-làm-việc-với-1-số-kiểu-dữ-liệu"><span class="toc-section-number">8</span> Làm việc với 1 số kiểu dữ liệu<span></span></a>
<ul>
<li><a href="làm-việc-với-1-số-kiểu-dữ-liệu.html#xử-lý-dữ-liệu-dạng-text" id="toc-xử-lý-dữ-liệu-dạng-text"><span class="toc-section-number">8.1</span> Xử lý dữ liệu dạng text<span></span></a></li>
<li><a href="làm-việc-với-1-số-kiểu-dữ-liệu.html#xử-lý-dữ-liệu-dạng-timestamp" id="toc-xử-lý-dữ-liệu-dạng-timestamp"><span class="toc-section-number">8.2</span> Xử lý dữ liệu dạng timestamp<span></span></a></li>
<li><a href="làm-việc-với-1-số-kiểu-dữ-liệu.html#category-trong-pandas" id="toc-category-trong-pandas"><span class="toc-section-number">8.3</span> Category trong pandas<span></span></a></li>
<li><a href="làm-việc-với-1-số-kiểu-dữ-liệu.html#xử-lý-missing-data" id="toc-xử-lý-missing-data"><span class="toc-section-number">8.4</span> Xử lý Missing data<span></span></a></li>
</ul></li>
<li><a href="một-số-kiến-thức-nâng-cao.html#một-số-kiến-thức-nâng-cao" id="toc-một-số-kiến-thức-nâng-cao"><span class="toc-section-number">9</span> Một số kiến thức nâng cao<span></span></a>
<ul>
<li><a href="một-số-kiến-thức-nâng-cao.html#multiindex" id="toc-multiindex"><span class="toc-section-number">9.1</span> MultiIndex<span></span></a></li>
<li><a href="một-số-kiến-thức-nâng-cao.html#pivot-và-merge" id="toc-pivot-và-merge"><span class="toc-section-number">9.2</span> Pivot và Merge<span></span></a></li>
<li><a href="một-số-kiến-thức-nâng-cao.html#resample" id="toc-resample"><span class="toc-section-number">9.3</span> Resample<span></span></a></li>
<li><a href="một-số-kiến-thức-nâng-cao.html#window" id="toc-window"><span class="toc-section-number">9.4</span> Window<span></span></a></li>
</ul></li>
<li><a href="anomaly-detection-project.html#anomaly-detection-project" id="toc-anomaly-detection-project"><span class="toc-section-number">10</span> Anomaly Detection Project<span></span></a></li>
<li><a href="visualize-với-matplotlib.html#visualize-với-matplotlib" id="toc-visualize-với-matplotlib"><span class="toc-section-number">11</span> Visualize với Matplotlib<span></span></a></li>
<li class="divider"></li>
<li><a href="" target="blank">Lê Huỳnh Đức</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Kungfu Pandas</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="tính-toán-trên-các-phần-tử-trong-pandas" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chương 5</span> Tính toán trên các phần tử trong Pandas<a href="tính-toán-trên-các-phần-tử-trong-pandas.html#tính-toán-trên-các-phần-tử-trong-pandas" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div class="sourceCode" id="cb122"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb122-1"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb122-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">&#39;data/big_mart_sales.csv&#39;</span>)</span></code></pre></div>
<div id="sử-dụng-vectorization" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Sử dụng Vectorization<a href="tính-toán-trên-các-phần-tử-trong-pandas.html#sử-dụng-vectorization" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Giả sử như muốn tạo cột <code>price</code>= <code>Item_Outlet_Sales</code> * <code>5%</code></p>
<div class="sourceCode" id="cb123"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb123-1"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb123-1" aria-hidden="true" tabindex="-1"></a>In []: df[<span class="st">&#39;price&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;Item_Outlet_Sales&#39;</span>] <span class="op">*</span> <span class="fl">0.05</span></span>
<span id="cb123-2"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb123-2" aria-hidden="true" tabindex="-1"></a>In []: df[[<span class="st">&#39;Item_Outlet_Sales&#39;</span>, <span class="st">&#39;price&#39;</span>]]</span>
<span id="cb123-3"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb123-3" aria-hidden="true" tabindex="-1"></a>Out[]:</span>
<span id="cb123-4"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb123-4" aria-hidden="true" tabindex="-1"></a>      Item_Outlet_Sales      price</span>
<span id="cb123-5"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb123-5" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>             <span class="fl">3735.1380</span>  <span class="fl">186.75690</span></span>
<span id="cb123-6"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb123-6" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>              <span class="fl">443.4228</span>   <span class="fl">22.17114</span></span>
<span id="cb123-7"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb123-7" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>             <span class="fl">2097.2700</span>  <span class="fl">104.86350</span></span>
<span id="cb123-8"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb123-8" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>              <span class="fl">732.3800</span>   <span class="fl">36.61900</span></span>
<span id="cb123-9"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb123-9" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>              <span class="fl">994.7052</span>   <span class="fl">49.73526</span></span>
<span id="cb123-10"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb123-10" aria-hidden="true" tabindex="-1"></a>...                 ...        ...</span>
<span id="cb123-11"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb123-11" aria-hidden="true" tabindex="-1"></a><span class="dv">8518</span>          <span class="fl">2778.3834</span>  <span class="fl">138.91917</span></span>
<span id="cb123-12"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb123-12" aria-hidden="true" tabindex="-1"></a><span class="dv">8519</span>           <span class="fl">549.2850</span>   <span class="fl">27.46425</span></span>
<span id="cb123-13"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb123-13" aria-hidden="true" tabindex="-1"></a><span class="dv">8520</span>          <span class="fl">1193.1136</span>   <span class="fl">59.65568</span></span>
<span id="cb123-14"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb123-14" aria-hidden="true" tabindex="-1"></a><span class="dv">8521</span>          <span class="fl">1845.5976</span>   <span class="fl">92.27988</span></span>
<span id="cb123-15"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb123-15" aria-hidden="true" tabindex="-1"></a><span class="dv">8522</span>           <span class="fl">765.6700</span>   <span class="fl">38.28350</span></span></code></pre></div>
<p>Nối hai cột lại với nhau, Ví dụ
- nối <code>Item_type</code> và <code>Item_Fat_Content</code> thành <code>Item_Type_Fat_Content</code>
- nối <code>Outlet_Identifier</code> và <code>Outlet_Establishment_Year</code> thành <code>Outlet_Identifier_Establishment_Year</code>. Trong trường hợp hợp này <code>Outlet_Establishment_Year</code> thuộc dạng số nên để nối dạng text và số ta ép kiểu dạng số về text sử dụng <code>astype()</code></p>
<div class="sourceCode" id="cb124"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb124-1"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb124-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;Item_Type_Fat_Content&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;Item_Type&#39;</span>] <span class="op">+</span> <span class="st">&#39;_&#39;</span> <span class="op">+</span> df[<span class="st">&#39;Item_Fat_Content&#39;</span>]</span>
<span id="cb124-2"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb124-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;Outlet_Identifier_Establishment_Year&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;Outlet_Identifier&#39;</span>] <span class="op">+</span> <span class="st">&#39;_&#39;</span> <span class="op">+</span>df[<span class="st">&#39;Outlet_Establishment_Year&#39;</span>].astype(<span class="st">&#39;str&#39;</span>)</span>
<span id="cb124-3"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb124-3" aria-hidden="true" tabindex="-1"></a>df[[<span class="st">&#39;Item_Type_Fat_Content&#39;</span>, <span class="st">&#39;Outlet_Identifier_Establishment_Year&#39;</span>]]</span></code></pre></div>
<div class="sourceCode" id="cb125"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb125-1"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb125-1" aria-hidden="true" tabindex="-1"></a>              Item_Type_Fat_Content Outlet_Identifier_Establishment_Year</span>
<span id="cb125-2"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>                     Dairy_Low Fat                          OUT049_1999</span>
<span id="cb125-3"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb125-3" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>               Soft Drinks_Regular                          OUT018_2009</span>
<span id="cb125-4"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb125-4" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>                      Meat_Low Fat                          OUT049_1999</span>
<span id="cb125-5"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb125-5" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>     Fruits <span class="kw">and</span> Vegetables_Regular                          OUT010_1998</span>
<span id="cb125-6"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb125-6" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>                 Household_Low Fat                          OUT013_1987</span>
<span id="cb125-7"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb125-7" aria-hidden="true" tabindex="-1"></a>...                             ...                                  ...</span>
<span id="cb125-8"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb125-8" aria-hidden="true" tabindex="-1"></a><span class="dv">8518</span>            Snack Foods_Low Fat                          OUT013_1987</span>
<span id="cb125-9"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb125-9" aria-hidden="true" tabindex="-1"></a><span class="dv">8519</span>           Baking Goods_Regular                          OUT045_2002</span>
<span id="cb125-10"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb125-10" aria-hidden="true" tabindex="-1"></a><span class="dv">8520</span>     Health <span class="kw">and</span> Hygiene_Low Fat                          OUT035_2004</span>
<span id="cb125-11"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb125-11" aria-hidden="true" tabindex="-1"></a><span class="dv">8521</span>            Snack Foods_Regular                          OUT018_2009</span>
<span id="cb125-12"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb125-12" aria-hidden="true" tabindex="-1"></a><span class="dv">8522</span>            Soft Drinks_Low Fat                          OUT046_1997</span></code></pre></div>
</div>
<div id="sử-dụng-apply" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Sử dụng apply<a href="tính-toán-trên-các-phần-tử-trong-pandas.html#sử-dụng-apply" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Phương thức <code>apply</code> để thực thi một hàm theo dòng hoặc cột
Đối với Series</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb126-1"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb126-1" aria-hidden="true" tabindex="-1"></a>Series.<span class="bu">apply</span>(func, convert_dtype<span class="op">=</span><span class="va">True</span>, args<span class="op">=</span>(), <span class="op">**</span>kwargs)</span></code></pre></div>
<p>Trong đó:</p>
<ul>
<li><p><code>func</code>: là hàm cần thực thi</p></li>
<li><p><code>convert_dtype</code>: Giá trị kiểu boolean. Nếu nó được đặt thành True (mặc định), xử lý dữ liệu sẽ cố gắng tìm dtype tốt hơn cho các kết quả của hàm ‘func’. Nếu False, thì dtype sẽ là type(object)</p></li>
<li><p><code>args</code>: Các đối số của hàm</p></li>
</ul>
<p>Ví dụ, tạo cột <code>price</code>= <code>Item_Outlet_Sales</code> * <code>5%</code></p>
<p>Sử dụng lambda function</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb127-1"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb127-1" aria-hidden="true" tabindex="-1"></a>In []: df[<span class="st">&#39;Item_Outlet_Sales&#39;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: x <span class="op">*</span> <span class="fl">0.05</span>)</span>
<span id="cb127-2"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb127-2" aria-hidden="true" tabindex="-1"></a>Out[]:</span>
<span id="cb127-3"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb127-3" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>       <span class="fl">186.75690</span></span>
<span id="cb127-4"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb127-4" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>        <span class="fl">22.17114</span></span>
<span id="cb127-5"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb127-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>       <span class="fl">104.86350</span></span>
<span id="cb127-6"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb127-6" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>        <span class="fl">36.61900</span></span>
<span id="cb127-7"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb127-7" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>        <span class="fl">49.73526</span></span>
<span id="cb127-8"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb127-8" aria-hidden="true" tabindex="-1"></a>          ...    </span>
<span id="cb127-9"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb127-9" aria-hidden="true" tabindex="-1"></a><span class="dv">8518</span>    <span class="fl">138.91917</span></span>
<span id="cb127-10"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb127-10" aria-hidden="true" tabindex="-1"></a><span class="dv">8519</span>     <span class="fl">27.46425</span></span>
<span id="cb127-11"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb127-11" aria-hidden="true" tabindex="-1"></a><span class="dv">8520</span>     <span class="fl">59.65568</span></span>
<span id="cb127-12"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb127-12" aria-hidden="true" tabindex="-1"></a><span class="dv">8521</span>     <span class="fl">92.27988</span></span>
<span id="cb127-13"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb127-13" aria-hidden="true" tabindex="-1"></a><span class="dv">8522</span>     <span class="fl">38.28350</span></span>
<span id="cb127-14"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb127-14" aria-hidden="true" tabindex="-1"></a>Name: Item_Outlet_Sales, Length: <span class="dv">8523</span>, dtype: float64</span></code></pre></div>
<p>Sử dụng hàm tự định nghĩa</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb128-1"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> set_price(x, k<span class="op">=</span><span class="fl">0.05</span>):</span>
<span id="cb128-2"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb128-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x <span class="op">*</span> k</span></code></pre></div>
<div class="sourceCode" id="cb129"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb129-1"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb129-1" aria-hidden="true" tabindex="-1"></a>In []: df[<span class="st">&#39;Item_Outlet_Sales&#39;</span>].<span class="bu">apply</span>(set_price)</span>
<span id="cb129-2"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb129-2" aria-hidden="true" tabindex="-1"></a>Out[]: </span>
<span id="cb129-3"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb129-3" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>       <span class="fl">186.75690</span></span>
<span id="cb129-4"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb129-4" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>        <span class="fl">22.17114</span></span>
<span id="cb129-5"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb129-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>       <span class="fl">104.86350</span></span>
<span id="cb129-6"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb129-6" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>        <span class="fl">36.61900</span></span>
<span id="cb129-7"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb129-7" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>        <span class="fl">49.73526</span></span>
<span id="cb129-8"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb129-8" aria-hidden="true" tabindex="-1"></a>          ...    </span>
<span id="cb129-9"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb129-9" aria-hidden="true" tabindex="-1"></a><span class="dv">8518</span>    <span class="fl">138.91917</span></span>
<span id="cb129-10"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb129-10" aria-hidden="true" tabindex="-1"></a><span class="dv">8519</span>     <span class="fl">27.46425</span></span>
<span id="cb129-11"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb129-11" aria-hidden="true" tabindex="-1"></a><span class="dv">8520</span>     <span class="fl">59.65568</span></span>
<span id="cb129-12"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb129-12" aria-hidden="true" tabindex="-1"></a><span class="dv">8521</span>     <span class="fl">92.27988</span></span>
<span id="cb129-13"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb129-13" aria-hidden="true" tabindex="-1"></a><span class="dv">8522</span>     <span class="fl">38.28350</span></span>
<span id="cb129-14"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb129-14" aria-hidden="true" tabindex="-1"></a>Name: Item_Outlet_Sales, Length: <span class="dv">8523</span>, dtype: float64</span></code></pre></div>
<p>Có thể truyền tham số <code>k</code> vào hàm <code>set_price</code> bằng hai cách</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb130-1"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cách 1 - Dùng lambda</span></span>
<span id="cb130-2"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb130-2" aria-hidden="true" tabindex="-1"></a>In []: df[<span class="st">&#39;Item_Outlet_Sales&#39;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: set_price(x, <span class="fl">0.1</span>))</span>
<span id="cb130-3"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb130-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-4"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb130-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Cách 2 - Dùng `arg`</span></span>
<span id="cb130-5"><a href="tính-toán-trên-các-phần-tử-trong-pandas.html#cb130-5" aria-hidden="true" tabindex="-1"></a>In []: df[<span class="st">&#39;Item_Outlet_Sales&#39;</span>].<span class="bu">apply</span>(set_price, k<span class="op">=</span><span class="fl">0.1</span>)</span></code></pre></div>
</div>
<div id="sử-dụng-iterator" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Sử dụng iterator<a href="tính-toán-trên-các-phần-tử-trong-pandas.html#sử-dụng-iterator" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="xử-lý-song-song-trong-pandas" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Xử lý song song trong pandas<a href="tính-toán-trên-các-phần-tử-trong-pandas.html#xử-lý-song-song-trong-pandas" class="anchor-section" aria-label="Anchor link to header"></a></h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="selecting-và-filtering.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="các-cách-phối-hợp-nhiều-bảng-với-nhau.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "Merriweather",
"size": 4
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection",
"toc_depth": 2,
"scroll_highlight": true
}
});
});
</script>

</body>

</html>
